name: O Grande Filtro (Symbiont Auto-Consensus)

on:
  pull_request:
    branches: [ "main" ]
    paths:
      - 'blockchain.json' # O Rob√¥ s√≥ acorda se mexerem no dinheiro

jobs:
  prova_de_trabalho:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write

    steps:
    - name: Baixar o Universo (Checkout)
      uses: actions/checkout@v3

    - name: Preparar Ambiente (Python)
      uses: actions/setup-python@v3
      with:
        python-version: "3.10"

    - name: Instalar Ferramentas
      run: |
        pip install ecdsa

    - name: üõ°Ô∏è AUDITORIA MATEM√ÅTICA E CRIPTOGR√ÅFICA
      id: auditoria
      run: |
        python auditoria.py

    - name:   CONSENSO AUTOM√ÅTICO (Merge)
      if: success() # S√≥ roda se a auditoria passou
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        gh pr merge ${{ github.event.pull_request.number }} --merge --admin --delete-branch
        echo "  BLOCO ACEITO E IMORTALIZADO PELO SISTEMA."

